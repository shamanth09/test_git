<script th:src="@{/resources/libs/jquery.validate.js}"></script>
<script th:src="@{/resources/libs/select2/js/select2.min.js}"
	type="text/javascript"></script>
<script th:src="@{/resources/libs/dropzone.min.js}"></script>
<div class="content-bar">
	<ul class="breadcrumb breadcrumb-angle">
		<li><a href="#/" aria-label="home"><i class="fa fa-home"></i></a></li>
		<li><a href="#/">Categories</a></li>
		<li><a th:href="'#/'+${product.category.id}"
			th:text="${product.category.name}"></a></li>
		<li class="active"><a th:href="'#/products/'+${product.id}"
			th:text="${product.name}"></a></li>
	</ul>
</div>
<!-- /.content-bar -->

<div class="content-body product-edit">
	<div class="row">
		<div class="col-md-12">
			<div class="panel" data-fill-color="true">
				<div class="panel-heading">
					<h3 class="panel-title">
						<i class="icon-note fa-fw"></i> <span th:text="${product.name}"></span>
					</h3>
				</div>
				<!-- /panel-heading -->
				<div class="panel-body">
					<div class="col-md-6">
						<form role="form" th:action="@{'products/xhr/'+*{id}}"
							th:object="${product}" method="post" validate-form=""
							submit-handler="updateProduct">
							<input type="hidden" class="form-control" th:field="*{id}"
								required="required" />
							<div class="form-group">
								<label class="control-label" for="name">Name</label> <input
									type="text" class="form-control" th:field="*{name}"
									required="required" />
							</div>
							<!-- /.form-group -->
							<div class="form-group">
								<label class="control-label" for="basicPasswd">SKU</label> <input
									class="form-control" type="text" th:field="*{sku}"
									required="required" />
							</div>
							<div class="form-group">
								<label class="control-label" for="select2">Category</label> <select
									style="width: 100%" data-input="select2"
									placeholder="Select Category" th:field="*{category.id}"
									select2="" required="required">
									<option th:each="category : ${categoryPage.content}"
										th:text="${category.name}" th:value="${category.id}"></option>
								</select>
							</div>
							<!-- /.form-group -->
							<div class="form-group">
								<label class="control-label" for="basicEmail">Measurements</label>
								<select class="form-control" name="measurements"  select2=""
									multiple="multiple">
									<option th:each="meas : ${measurements}" th:value="${meas.id}"
										th:selected="${product.measurements.contains(meas)}"
										th:text="${meas.measurementValue}"></option>
								</select>
							</div>
							<!-- /.form-group -->
							<div class="form-group clearfix">
								<div class="pull-right">
									<a th:href="'#/products/'+${product.id}"
										class="btn btn-default">Cancel</a>
									<button type="submit" class="btn btn-primary">Update</button>
								</div>
							</div>
							<!-- /.form-group -->
						</form>
						<!-- /form -->
					</div>
					<div class="col-md-3 col-md-offset-2">
						<form
							th:action="@{products/xhr/{productId}/images(productId=${product.id})}"
							class="dropzone border-teal" dropzone="" method="post"
							enctype="multipart/form-data" maxFilesize="2"
							style="text-align: center;"
							th:attr="image-url=${product.image!=null}?@{products/{productId}/images(productId=${product.id})}"
							th:headers="'{\''+${_csrf.headerName}+'\':\''+${_csrf.token}+'\'}'"
							th:title="${product.name}">
							<div class="fallback">
								<input name="file" type="file" />
							</div>
							<div class="dz-message">
								<h3>Drop files here or click to upload.</h3>
							</div>
						</form>

					</div>
				</div>
				<!-- /panel-body -->
				<!-- /panel -->
			</div>
		</div>
	</div>
</div>
<script th:inline="javascript">
productApp.value("product",{
	"id":/*[[${product.id}]]*/,
	"name":/*[[${product.name}]]*/
});
</script>
